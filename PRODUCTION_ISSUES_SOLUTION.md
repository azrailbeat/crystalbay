# Crystal Bay Travel - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 46.250.234.89

### üîç –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. **–û—à–∏–±–∫–∞ —Ç–æ–∫–µ–Ω–∞: "Unexpected token '<'"**
- **–ü—Ä–∏—á–∏–Ω–∞**: SAMO API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç HTML –≤–º–µ—Å—Ç–æ JSON
- **–°—Ç–∞—Ç—É—Å**: 403 Forbidden - –ø—Ä–æ–±–ª–µ–º–∞ —Å IP whitelist –∏–ª–∏ OAuth —Ç–æ–∫–µ–Ω–æ–º

#### 2. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤**
- **–ì–æ—Ä–æ–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∏—è**: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- **–°—Ç—Ä–∞–Ω—ã –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è**: –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏  
- **–°—Ç–∞—Ç—É—Å**: –í—Å–µ —Å–≤—è–∑–∞–Ω–æ —Å 403 Forbidden –æ—Ç SAMO API

#### 3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞, –Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞**
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ü—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –≤ –¥–æ—Å—Ç—É–ø–µ –∫ SAMO API

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

#### 1. **–°–∏—Å—Ç–µ–º–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–¥–∞–∫—à–Ω —Å–µ—Ä–≤–µ—Ä–∞**
–°–æ–∑–¥–∞–Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

- **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**: `/api/diagnostics/environment`
- **SAMO API —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ**: `/api/diagnostics/samo`  
- **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ**: `/api/diagnostics/server`
- **Curl –∫–æ–º–∞–Ω–¥—ã**: `/api/diagnostics/curl`

#### 2. **–£–ª—É—á—à–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å SAMO —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
- –ö–Ω–æ–ø–∫–∞ "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞" –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≤–µ—Ç–æ–≤ API
- Curl –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### 3. **–î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- –ü–æ–∫–∞–∑ HTTP —Å—Ç–∞—Ç—É—Å –∫–æ–¥–æ–≤
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–≤–µ—Ç–æ–≤
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–∫–µ–Ω–∞—Ö (–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)

### üõ†Ô∏è –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è

#### –ö—Ä–∏—Ç–∏—á–Ω–æ - —Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ SAMO:

1. **–î–æ–±–∞–≤–∏—Ç—å IP —Å–µ—Ä–≤–µ—Ä–∞ –≤ whitelist SAMO API**
   ```
   –¢–µ–∫—É—â–∏–π IP —Å–µ—Ä–≤–µ—Ä–∞: 46.250.234.89
   –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ whitelist: booking.crystalbay.com
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å OAuth —Ç–æ–∫–µ–Ω**
   ```
   –¢–µ–∫—É—â–∏–π —Ç–æ–∫–µ–Ω: 27bd59a7ac67422189789f0188167379
   –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ç–æ–∫–µ–Ω –∞–∫—Ç–∏–≤–µ–Ω –∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω
   ```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É**
   - –ü–µ—Ä–µ–π—Ç–∏: `46.250.234.89:5000/samo-testing`
   - –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
   - –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∞–∫–∫–æ—Ä–¥–µ–æ–Ω—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π

2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ curl**
   ```bash
   curl -X POST 'https://booking.crystalbay.com/export/default.php' \
     -H 'User-Agent: Crystal Bay Travel Production/1.0' \
     -H 'Accept: application/json' \
     -H 'Content-Type: application/x-www-form-urlencoded' \
     -d 'samo_action=api&version=1.0&type=json&action=SearchTour_CURRENCIES&oauth_token=27bd59a7ac67422189789f0188167379' \
     -v --connect-timeout 15 --max-time 30
   ```

### üìã –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

#### –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ SAMO API:
- [ ] IP 46.250.234.89 –¥–æ–±–∞–≤–ª–µ–Ω –≤ whitelist
- [ ] OAuth —Ç–æ–∫–µ–Ω 27bd59a7ac67422189789f0188167379 –∞–∫—Ç–∏–≤–µ–Ω
- [ ] Endpoint https://booking.crystalbay.com/export/default.php –¥–æ—Å—Ç—É–ø–µ–Ω

#### –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞:
- [x] –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ endpoints –¥–æ—Å—Ç—É–ø–Ω—ã
- [x] –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω
- [x] –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (8/9 —Ç–µ—Å—Ç–æ–≤)

### üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è IP –≤ whitelist SAMO API:

1. **SAMO API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ–∫–∞–∂–µ—Ç –∑–µ–ª–µ–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã
2. **–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏** (—Å—Ç—Ä–∞–Ω—ã, –≥–æ—Ä–æ–¥–∞, –≤–∞–ª—é—Ç—ã) –∑–∞–≥—Ä—É–∑—è—Ç—Å—è
3. **–ü–æ–∏—Å–∫ —Ç—É—Ä–æ–≤** —Å—Ç–∞–Ω–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º
4. **–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ SAMO API
5. **–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞** –∫ –ø–æ–ª–Ω–æ–º—É –ø—Ä–æ–¥–∞–∫—à–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### üöÄ –°—Ç–∞—Ç—É—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–°–∏—Å—Ç–µ–º–∞ Crystal Bay Travel:**
- ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç  
- ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚è≥ –û–∂–∏–¥–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è SAMO API (IP whitelist)

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –°–≤—è–∑–∞—Ç—å—Å—è —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º SAMO API –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è IP 46.250.234.89 –≤ whitelist.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.